<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Customer Management</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Main Dashboard Theme -->
    <link rel="stylesheet" href="{{ url_for('static',filename='dashborad.css') }}">

    <!-- Customer Page Styles -->
    <link rel="stylesheet" href="{{ url_for('static',filename='customer.css') }}">
</head>
<body>

    <!-- ================= MAIN CONTENT ================= -->
    <main class="main">

        <!-- ================= HEADER ================= -->
        <div class="topbar">
            <div>
                <h1>Customers</h1>
                <p>View and manage customer instrument records</p>
            </div>
        </div>

        <!-- ================= CUSTOMER LIST ================= -->
        <div class="panel">
            <h2>Customer List</h2>

            <table>
                <thead>
                    <tr>
                        <th>c_ID</th>
                        <th>Company Name</th>
                        <th>Company Type</th>
                        <th>Contact Name</th>
                        <th>Contact_mail</th>
                        <th>Contact_phone</th>
                        <th class="action-col">Actions</th>
                    </tr>
                </thead>
                <tbody id="customerTableBody">
                    <tr class="empty-row">
                        <td colspan="7">No records found</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- ================= ADD CUSTOMER ================= -->
        <div class="panel">
            <h2>Add New Customer</h2>

            <form class="customer-form">
                <div class="form-group">
                    <label id="cid">C_ID *</label>
                    <input type="text" required>
                </div>
              
                <div class="form-group">
                    <label id="cname">Company Name *</label>
                    <input type="text" required>
                </div>

                <div class="form-group">
                    <label id="ctype">Company Type *</label>
                    <input type="text" required>
                </div>
              
                <div class="form-group">
                    <label id="ccname">Contact Name *</label>
                    <input type="text" required>
                </div>

                <div class="form-group">
                    <label id="cmail">Email *</label>
                    <input type="email" required>
                </div>

                <div class="form-group">
                    <label id="phone">Phone *</label>
                    <input type="tel" required>
                </div>

                <button type="submit" class="btn-save" onclick='saved()'>
                    Save Customer
                </button>
            </form>
        </div>

    </main>

</body>
<!--<script src="{{ url_for('static',filename='customer.js') }}"></script>-->
<script>

/* Add customer details in data */
const data = {
        company_id: document.getElementById("cid").value,
        company_name: document.getElementById("cname").value,
        company_type: document.getElementById("ctype").value,
        conatct_name: document.getElementById("ccname").value,
        cantact_mail: document.getElementById("cmail").value,
        contact_phone: document.getElementById("phone").value
    };

    fetch("/api/customers", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(response => {
        alert(response.message);
        document.getElementById("customerForm").reset();
    
    })
    .catch(err => console.error("Error:", err));
});   
}

/* Load Customer Table */
fetch("/api/customers")
  .then(r => r.json())
  .then(data => {
    const tbody = document.getElementById("customerTableBody");
    tbody.innerHTML = "";

if (data.length === 0) {
    // show NOTHING when empty (as requested)
} else {
    data.forEach(c => {
        tbody.innerHTML += `
            <tr>
                <td>${c.company_id}</td>
                <td>${c.company_name}</td>
                <td>${c.company_type}</td>
                <td>${c.conatct_name}</td>
                <td>${c.cantact_mail}</td>
                <td>${c.contact_phone}</td>
                <td class="action-col">
                    <button class="btn-edit" onclick="editCustomer(${c.company_id})">Edit</button>
                    <button class="btn-delete" onclick="deleteCustomer(${c.company_id})">Delete</button>
                </td>
            </tr>
        `;
    });
}
})
.catch(err => console.error("Error:", err));
</script>
</html>
