<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Service Management System</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>

  <div class="container">
    <!-- Logo -->
    <div class="logo">
      <div class="logo-icon">ğŸ“„</div>
      <h1>Service Management System</h1>
      <p>Laboratory Equipment Service</p>
    </div>

    <!-- Card -->
    <div class="card">
      <h2>Sign In</h2>

      <form id="loginForm" onsubmit="handleLogin(event)">
        <label>Email Address</label>
        <div class="input-box">
          <span>âœ‰ï¸</span>
          <input type="email" id="email" placeholder="you@example.com" required />
        </div>

        <label>Password</label>
        <div class="input-box">
          <span>ğŸ”’</span>
          <input type="password" id="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required />
        </div>

        <button type="submit" class="btn-primary">
          â†’ Sign In
        </button>
      </form>

      <div class="divider">
        <span>Or continue with</span>
      </div>

      <button class="btn-google">
        <img src="https://www.svgrepo.com/show/355037/google.svg" alt="Google" />
        Sign in with Google
      </button>

      <p class="signup-text">
        Don't have an account? <a href="#">Sign up</a>
      </p>
    </div>
  </div>
<script src="auth.js"></script>
<script>
function handleLogin(event) {
    event.preventDefault();

    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    const messageDiv = document.getElementById("message");
    const loginBtn = document.getElementById("loginBtn");

    loginBtn.disabled = true;
    loginBtn.textContent = "Signing in...";

    fetch("/api/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
    })
    .then(res => res.json())
    .then(res => {
        if (!res.success) {
            messageDiv.className = "message error";
            messageDiv.innerText = res.error;
            loginBtn.disabled = false;
            loginBtn.textContent = "Sign In";
        } else {
            localStorage.setItem("user_email", res.email);

            messageDiv.className = "message success";
            messageDiv.innerText = "Login successful";

            setTimeout(() => {
                window.location.href="/dashboard";
            }, 1000);
        }
    })
    .catch(() => {
        messageDiv.className = "message error";
        messageDiv.innerText = "Server error";
        loginBtn.disabled = false;
        loginBtn.textContent = "Sign In";
    });
}
</script>
</body>
</html>
